{"version":3,"sources":["../../tinybi/dist/index.js","../../tinybi/dist/arrayHelpers.js","../../tinybi/dist/QueryColumn.js","../../tinybi-react/dist/DropDown.js","../../tinybi-react/dist/Layouts.js","../../tinybi-react/dist/TinyBIChartBox.js","../../tinybi-react/dist/TinyBITable.js","../../tinybi-react/dist/usePageFilters.js","../../tinybi-react/dist/useQuery.js","demoSchema.ts","Reports/dataColours.ts","../../tinybi-react-chartjs/dist/makeClickHandler.js","Reports/ResolvedPerCustomer.tsx","Reports/SourceOfErrors.tsx","Reports/TypesOfError.tsx","Reports/RecoverySummary.tsx","Reports/BugsOverTime.tsx","Reports/BugReporting.tsx","FilterPane.tsx","database.ts","localFetch.ts","App.tsx","serviceWorker.ts","index.tsx","../../tinybi/dist/executeQuery.js","../../tinybi/dist/QueryValues.js","../../tinybi/dist/smartDates.js","../../tinybi/dist/queryModel.js"],"names":["distinct","arr","map","_i","arr_1","length","item","Object","values","keysOf","obj","keys","QueryColumn","name","this","prototype","aggregation","aggregationType","filters","column","function","count","sum","filter","operator","value","ascending","descending","equalTo","notEqualTo","greaterThan","lessThan","greaterThanOrEqualTo","lessThanOrEqualTo","DropDown","_a","options","onChange","React","createElement","x","key","__assign","assign","t","s","i","n","arguments","p","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","LayoutElement","_b","_c","children","type","dimension","sizes","otherProps","nonNullSizes","totalSize","Children","_","reduce","l","r","unit","style","display","flexDirection","width","height","child","className","Row","props","Column","Layout","TinyBIChartBox","id","title","renderCell","def","align","TinyBITable","data","columns","records","record","JSON","stringify","selected","QueryValuesRow","totals","QueryValuesTotal","clearedState","global","interactions","interactionKey","useQuery","fetch","query","queryJson","jsonifyQuery","useState","result","setResult","queryJsonStr","stableStringify","useEffect","executeQuery","then","expandQueryResult","select","DateReported","Id","CalendarYearNumber","FirstDayOfQuarter","FirstDayOfMonth","Workflow","Resolved","WorkflowState","SourceOfError","FixedByCustomer","Customer","CustomerName","CategoryCombination","Crashed","DataLoss","SecurityBreach","OffByOne","Slow","StackOverflow","Bug","WorkflowId","CustomerId","ReportedDate","ResolvedDate","AssignedDate","CategoryCombinationId","AssignedCoderId","ResolvedCoderId","dataColours","makeClickHandler","chartRef","funcOrColumns","pageFilters","func","getColumnsOnly","c","onClick","evt","chart","element","getElementAtEvent","_chart","labelIndex","_index","datasetIndex","_datasetIndex","category","labels","legend","datasets","label","getEventData","current","chartInstance","setInteraction","stopPropagation","ResolvedPerCustomer","customer","bugCount","getFilters","ref","useRef","clickHandler","backgroundColor","SourceOfErrors","sourceOfError","console","log","categories","TypesOfError","categoryBits","workflowState","distinctWorkflowStates","bugCountByStateAndCategory","flatMap","bit","bugCountByCategory","sort","y","orderedCategories","scales","xAxes","stacked","yAxes","ticks","beginAtZero","colour","find","RecoverySummary","fixedByCustomer","state","resolvedBugCount","State","d","Count","percentage","dateGroupings","BugsOverTime","dateGrouping","selectedLabel","setSelectedLabel","target","useDropDown","period","countAllCauses","countHackers","orderBy","datedRecords","smartDates","dateLabel","hackers","lineTension","borderColor","allCauses","BugReporting","toDateString","toISOString","substr","useDateInput","init","editing","setEditing","applied","setApplied","dirty","event","initCounter","useFilterPane","visible","setVisible","from","Date","setFullYear","getFullYear","lastYear","to","dates","forEach","setGlobal","some","toggle","FilterPane","filterPane","db","a","publicUrl","window","sitePublicUrl","initSqlJs","locateFile","f","SQL","setupDb","Database","getDb","allocDb","makeRandomDate","setDate","getDate","Math","floor","random","formatDate","moment","format","pick","base","min","sourcesOfError","push","dateRows","m","getMonth","startOfQuarter","startOfMonth","join","workflows","resolved","workflowRows","categoryCombinations","b","categoryCombinationsRows","bugs","workflow","reported","assigned","catComb","coderAssigned","coderResolved","bugRows","initSql","run","sql","replace","exec","querySql","blazorReady","Promise","done","notifyBlazorReady","localFetch","DotNet","invokeMethodAsync","json","parsed","parse","jsonDateParser","stackTrace","error","firstValueIndex","endOfSelects","slice","aggregated","Chart","defaults","defaultFontFamily","usePointStyle","maintainAspectRatio","reports","reportNames","App","reportName","setReportName","set","clearInteraction","clearGlobal","clearAll","concat","usePageFilters","report","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message","others","getColumnPropsOnly","aggregations","getAggregatePropsOnly","getAggregateValuesOnly","expandQueryRecord","rawValue","total","percent","round","__spreadArrays","il","Array","k","j","jl","mapTo","diff","every","date","month","incr","results","latest","undefined","records_1","add"],"mappings":"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","file":"static/js/main.052d0af5.chunk.js","sourcesContent":["export * from \"./arrayHelpers\";\nexport * from \"./executeQuery\";\nexport * from \"./QueryColumn\";\nexport * from \"./QueryJson\";\nexport * from \"./queryModel\";\nexport * from \"./QueryValues\";\nexport * from \"./smartDates\";\n","export function distinct(arr) {\n    var map = {};\n    for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\n        var item = arr_1[_i];\n        map[\"\" + item] = item;\n    }\n    return Object.values(map);\n}\nexport function keysOf(obj) {\n    return Object.keys(obj);\n}\n","var QueryColumn = /** @class */ (function () {\n    function QueryColumn(name) {\n        this.name = name;\n    }\n    QueryColumn.prototype.aggregation = function (aggregationType, filters) {\n        return {\n            column: this.name,\n            function: aggregationType,\n            filters: filters,\n        };\n    };\n    QueryColumn.prototype.count = function (filters) {\n        return this.aggregation(\"count\", filters);\n    };\n    QueryColumn.prototype.sum = function (filters) {\n        return this.aggregation(\"sum\", filters);\n    };\n    QueryColumn.prototype.filter = function (operator, value) {\n        return {\n            column: this.name,\n            operator: operator,\n            value: value,\n        };\n    };\n    QueryColumn.prototype.ascending = function () {\n        return { column: this.name, descending: false };\n    };\n    QueryColumn.prototype.descending = function () {\n        return { column: this.name, descending: true };\n    };\n    QueryColumn.prototype.equalTo = function (value) {\n        return this.filter(\"=\", value);\n    };\n    QueryColumn.prototype.notEqualTo = function (value) {\n        return this.filter(\"<>\", value);\n    };\n    QueryColumn.prototype.greaterThan = function (value) {\n        return this.filter(\">\", value);\n    };\n    QueryColumn.prototype.lessThan = function (value) {\n        return this.filter(\"<\", value);\n    };\n    QueryColumn.prototype.greaterThanOrEqualTo = function (value) {\n        return this.filter(\">=\", value);\n    };\n    QueryColumn.prototype.lessThanOrEqualTo = function (value) {\n        return this.filter(\"<=\", value);\n    };\n    return QueryColumn;\n}());\nexport { QueryColumn };\n","import { useState } from \"react\";\nimport React from \"react\";\nexport function useDropDown(options) {\n    var _a = useState(options[0].label), selectedLabel = _a[0], setSelectedLabel = _a[1];\n    return {\n        options: options.map(function (x) { return x.label; }),\n        value: selectedLabel,\n        onChange: function (e) {\n            setSelectedLabel(e.target.value);\n        },\n        get selected() {\n            var _a, _b;\n            return _b = (_a = options.find(function (x) { return x.label === selectedLabel; })) === null || _a === void 0 ? void 0 : _a.value, (_b !== null && _b !== void 0 ? _b : options[0].value);\n        }\n    };\n}\nexport function DropDown(_a) {\n    var options = _a.options, value = _a.value, onChange = _a.onChange;\n    return (React.createElement(\"select\", { value: value, onChange: onChange }, options.map(function (x) { return React.createElement(\"option\", { key: x }, x); })));\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from \"react\";\nfunction LayoutElement(_a) {\n    var _b, _c;\n    var children = _a.children, type = _a.type, dimension = _a.dimension, sizes = _a.sizes, otherProps = __rest(_a, [\"children\", \"type\", \"dimension\", \"sizes\"]);\n    var nonNullSizes = (sizes !== null && sizes !== void 0 ? sizes : []);\n    var totalSize = (_c = (_b = React.Children.map(children, (function (_, i) { var _a; return _a = nonNullSizes[i], (_a !== null && _a !== void 0 ? _a : 1); }))) === null || _b === void 0 ? void 0 : _b.reduce(function (l, r) { return l + r; }, 0), (_c !== null && _c !== void 0 ? _c : 0));\n    var unit = totalSize ? 100 / totalSize : 0;\n    return (React.createElement(\"div\", __assign({}, otherProps, { style: { display: \"flex\", flexDirection: type, width: \"100%\", height: \"100%\" } }), React.Children.map(children, (function (child, i) {\n        var _a;\n        var _b;\n        return (React.createElement(\"div\", { className: \"layout-item\", style: (_a = {}, _a[dimension] = unit * (_b = nonNullSizes[i], (_b !== null && _b !== void 0 ? _b : 1)) + \"%\", _a) }, child));\n    }))));\n}\nexport var Row = function (props) { return React.createElement(LayoutElement, __assign({ type: \"row\", dimension: \"width\" }, props)); };\nexport var Column = function (props) { return React.createElement(LayoutElement, __assign({ type: \"column\", dimension: \"height\" }, props)); };\nexport function Layout(_a) {\n    var children = _a.children, otherProps = __rest(_a, [\"children\"]);\n    return React.createElement(\"div\", __assign({}, otherProps, { className: \"layout\" }), children);\n}\n","import React from \"react\";\nexport function TinyBIChartBox(_a) {\n    var id = _a.id, title = _a.title, children = _a.children;\n    return (React.createElement(\"div\", { className: \"chart-box\", id: id },\n        React.createElement(\"div\", { className: \"title\" }, title),\n        React.createElement(\"div\", { className: \"chart\" }, children)));\n}\n","import React from \"react\";\nimport { QueryValuesRow, QueryValuesTotal } from \"tinybi\";\nfunction renderCell(key, def) {\n    var value = typeof def === \"string\" ? def : def[0];\n    var align = typeof def === \"string\" ? \"left\" : def[1];\n    return (React.createElement(\"td\", { key: key, className: align }, value));\n}\nexport function TinyBITable(_a) {\n    var data = _a.data, columns = _a.columns;\n    return (React.createElement(\"table\", null,\n        React.createElement(\"thead\", null,\n            React.createElement(\"tr\", null, Object.keys(columns).map(function (column) { return (React.createElement(\"th\", { key: column }, column)); }))),\n        React.createElement(\"tbody\", null, data.records.map(function (record, i) {\n            var _a;\n            return (React.createElement(\"tr\", { key: (_a = JSON.stringify(record.selected), (_a !== null && _a !== void 0 ? _a : i)) }, Object.keys(columns).map(function (column) { return renderCell(column, columns[column](new QueryValuesRow(record, data.totals))); })));\n        })),\n        data.totals && (React.createElement(\"tfoot\", null,\n            React.createElement(\"tr\", null, Object.keys(columns).map(function (column) { return renderCell(column, columns[column](new QueryValuesTotal(data.totals))); }))))));\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useState } from \"react\";\nvar clearedState = {\n    global: [],\n    interactions: [],\n    interactionKey: \"\",\n};\nexport function usePageFilters() {\n    var _a = useState(clearedState), state = _a[0], set = _a[1];\n    function setInteraction(interactionKey, interactions) {\n        set(__assign(__assign({}, state), { interactionKey: interactionKey, interactions: interactions }));\n    }\n    function setGlobal(global) {\n        set(__assign(__assign({}, state), { global: global }));\n    }\n    function clearInteraction() {\n        set(__assign(__assign({}, state), { interactionKey: \"\", interactions: [] }));\n    }\n    function clearGlobal() {\n        set(__assign(__assign({}, state), { global: [] }));\n    }\n    function clearAll() {\n        set(clearedState);\n    }\n    function getFilters(key) {\n        var result = state.global;\n        return key !== state.interactionKey ? result.concat(state.interactions) : result;\n    }\n    return __assign(__assign({}, state), { setInteraction: setInteraction, setGlobal: setGlobal, clearInteraction: clearInteraction, clearGlobal: clearGlobal, clearAll: clearAll, getFilters: getFilters });\n}\n","import { useState, useEffect } from \"react\";\nimport { executeQuery, jsonifyQuery, expandQueryResult } from \"tinybi\";\nimport stableStringify from \"json-stable-stringify\";\nexport function useQuery(fetch, query) {\n    var queryJson = jsonifyQuery(query);\n    var _a = useState({ records: [] }), result = _a[0], setResult = _a[1];\n    var queryJsonStr = stableStringify(queryJson);\n    useEffect(function () {\n        executeQuery(fetch, queryJson).then(setResult);\n    }, [queryJsonStr]);\n    return expandQueryResult(query.select, result);\n}\n","import { QueryColumn } from \"tinybi\";\n\nexport const DateReported = {\n    Id: new QueryColumn<Date>(\"DateReported.Id\"),\n    CalendarYearNumber: new QueryColumn<number>(\"DateReported.CalendarYearNumber\"),\n    FirstDayOfQuarter: new QueryColumn<Date>(\"DateReported.FirstDayOfQuarter\"),\n    FirstDayOfMonth: new QueryColumn<Date>(\"DateReported.FirstDayOfMonth\"),\n};\n\nexport const DateResolved = {\n    Id: new QueryColumn<Date>(\"DateResolved.Id\"),\n    CalendarYearNumber: new QueryColumn<number>(\"DateResolved.CalendarYearNumber\"),\n    FirstDayOfQuarter: new QueryColumn<Date>(\"DateResolved.FirstDayOfQuarter\"),\n    FirstDayOfMonth: new QueryColumn<Date>(\"DateResolved.FirstDayOfMonth\"),\n};\n\nexport const DateAssigned = {\n    Id: new QueryColumn<Date>(\"DateAssigned.Id\"),\n    CalendarYearNumber: new QueryColumn<number>(\"DateAssigned.CalendarYearNumber\"),\n    FirstDayOfQuarter: new QueryColumn<Date>(\"DateAssigned.FirstDayOfQuarter\"),\n    FirstDayOfMonth: new QueryColumn<Date>(\"DateAssigned.FirstDayOfMonth\"),\n};\n\nexport const Workflow = {\n    Id: new QueryColumn<number>(\"Workflow.Id\"),\n    Resolved: new QueryColumn<boolean>(\"Workflow.Resolved\"),\n    WorkflowState: new QueryColumn<string>(\"Workflow.WorkflowState\"),\n    SourceOfError: new QueryColumn<string>(\"Workflow.SourceOfError\"),\n    FixedByCustomer: new QueryColumn<boolean>(\"Workflow.FixedByCustomer\"),\n};\n\nexport const Category = {\n    Id: new QueryColumn<number>(\"Category.Id\"),\n    Label: new QueryColumn<string>(\"Category.Label\"),\n};\n\nexport const Customer = {\n    Id: new QueryColumn<number>(\"Customer.Id\"),\n    CustomerName: new QueryColumn<string>(\"Customer.CustomerName\"),\n};\n\nexport const CoderAssigned = {\n    Id: new QueryColumn<number>(\"CoderAssigned.Id\"),\n    FullName: new QueryColumn<string>(\"CoderAssigned.FullName\"),\n};\n\nexport const CoderResolved = {\n    Id: new QueryColumn<number>(\"CoderResolved.Id\"),\n    FullName: new QueryColumn<string>(\"CoderResolved.FullName\"),\n};\n\nexport const CategoryCombination = {\n    Id: new QueryColumn<number>(\"CategoryCombination.Id\"),\n    Crashed: new QueryColumn<boolean>(\"CategoryCombination.Crashed\"),\n    DataLoss: new QueryColumn<boolean>(\"CategoryCombination.DataLoss\"),\n    SecurityBreach: new QueryColumn<boolean>(\"CategoryCombination.SecurityBreach\"),\n    OffByOne: new QueryColumn<boolean>(\"CategoryCombination.OffByOne\"),\n    Slow: new QueryColumn<boolean>(\"CategoryCombination.Slow\"),\n    StackOverflow: new QueryColumn<boolean>(\"CategoryCombination.StackOverflow\"),\n};\n\nexport const Bug = {\n    Id: new QueryColumn<number>(\"Bug.Id\"),\n    WorkflowId: new QueryColumn<number>(\"Bug.WorkflowId\"),\n    CustomerId: new QueryColumn<number>(\"Bug.CustomerId\"),\n    ReportedDate: new QueryColumn<Date>(\"Bug.ReportedDate\"),\n    ResolvedDate: new QueryColumn<Date>(\"Bug.ResolvedDate\"),\n    AssignedDate: new QueryColumn<Date>(\"Bug.AssignedDate\"),\n    CategoryCombinationId: new QueryColumn<number>(\"Bug.CategoryCombinationId\"),\n    AssignedCoderId: new QueryColumn<number>(\"Bug.AssignedCoderId\"),\n    ResolvedCoderId: new QueryColumn<number>(\"Bug.ResolvedCoderId\"),\n};\n\n","export const dataColours = [\"#722E85\", \"#CD65D9\", \"#3ED4B0\", \"#F54E7B\", \"#FF7676\", \"#FAD57A\", \"#313345\", \"#b4b2bc\"];\n","import { getColumnsOnly } from \"tinybi\";\nfunction getEventData(evt, chart) {\n    if (chart && evt) {\n        var element = chart.getElementAtEvent(evt)[0];\n        if (element) {\n            var data = element._chart.data;\n            var labelIndex = element._index;\n            var datasetIndex = element._datasetIndex;\n            return {\n                category: data.labels[labelIndex],\n                legend: data.datasets[datasetIndex].label,\n            };\n        }\n    }\n}\nexport function makeClickHandler(id, chartRef, funcOrColumns, pageFilters) {\n    var func = typeof funcOrColumns === \"function\" ? funcOrColumns :\n        function (keys) { return getColumnsOnly(funcOrColumns).map(function (c, i) { return c.equalTo(keys[i]); }); };\n    return {\n        onClick: function (evt) {\n            var _a, _b;\n            var data = getEventData(evt, (_a = chartRef.current) === null || _a === void 0 ? void 0 : _a.chartInstance);\n            if (data && pageFilters) {\n                var filters = func([data.category, data.legend]);\n                if (filters) {\n                    pageFilters.setInteraction(id, filters);\n                    (_b = evt) === null || _b === void 0 ? void 0 : _b.stopPropagation();\n                }\n            }\n        }\n    };\n}\n","import React, { useRef } from \"react\";\nimport { useQuery, TinyBIChartBox } from \"tinybi-react\";\nimport { Customer, Bug, Workflow } from \"../demoSchema\";\nimport { dataColours } from \"./dataColours\";\nimport { Pie } from \"react-chartjs-2\";\nimport { VisualProps } from \"./VisualProps\";\nimport { makeClickHandler } from \"tinybi-react-chartjs\";\n\nexport function ResolvedPerCustomer({ pageFilters, fetch }: VisualProps) {\n\n    const id = \"ResolvedPerCustomer\";\n\n    const query = {\n        select: {\n            customer: Customer.CustomerName,\n            bugCount: Bug.Id.count()\n        },\n        filters: [\n            Workflow.Resolved.equalTo(true),\n            ...pageFilters.getFilters(id)\n        ],\n    };\n\n    const ref = useRef<Pie>(null);\n    const result = useQuery(fetch, query);\n    const clickHandler = makeClickHandler(id, ref, query.select, pageFilters);\n    \n    return (\n        <TinyBIChartBox id={id} title=\"Resolved Per Customer\">\n            <Pie\n                ref={ref}\n                options={{ ...clickHandler }}\n                data={{\n                    labels: result.records.map(x => x.customer),\n                    datasets: [{\n                        label: \"Count\",\n                        backgroundColor: dataColours,\n                        data: result.records.map(x => x.bugCount)\n                    }]\n                }}\n            />\n        </TinyBIChartBox>        \n    );\n}\n","import React, { useRef } from \"react\";\nimport { useQuery, TinyBIChartBox } from \"tinybi-react\";\nimport { Bug, Workflow } from \"../demoSchema\";\nimport { dataColours } from \"./dataColours\";\nimport { Pie } from \"react-chartjs-2\";\nimport { VisualProps } from \"./VisualProps\";\nimport { makeClickHandler } from \"tinybi-react-chartjs\";\n\nconst id = \"SourceOfErrors\";\n\nexport function SourceOfErrors({ pageFilters, fetch }: VisualProps) {\n\n    const query = {\n        select: {\n            sourceOfError: Workflow.SourceOfError,\n            bugCount: Bug.Id.count()\n        },\n        filters: [\n            Workflow.Resolved.equalTo(true),\n            ...pageFilters.getFilters(id)\n        ],\n    };\n\n    console.log(pageFilters.getFilters(id));\n\n    const result = useQuery(fetch, query);\n\n    const ref = useRef<Pie>(null);\n    const clickHandler = makeClickHandler(id, ref, query.select, pageFilters);\n    \n    return (\n        <TinyBIChartBox id={id} title=\"Source Of Errors\">\n            <Pie\n                ref={ref}\n                options={{ ...clickHandler }} \n                data={{\n                    labels: result.records.map(x => x.sourceOfError),\n                    datasets: [{\n                        label: \"Count\",\n                        backgroundColor: dataColours,\n                        data: result.records.map(x => x.bugCount)\n                    }]\n                }}\n            />\n        </TinyBIChartBox>\n    );\n}\n","import React, { useRef } from \"react\";\nimport { QueryColumn, distinct, keysOf } from \"tinybi\";\nimport { useQuery, TinyBIChartBox } from \"tinybi-react\";\nimport { makeClickHandler } from \"tinybi-react-chartjs\";\nimport { Bug, Workflow, CategoryCombination } from \"../demoSchema\";\nimport { dataColours } from \"./dataColours\";\nimport { Bar } from \"react-chartjs-2\";\nimport { VisualProps } from \"./VisualProps\";\n\nconst categoriesRaw = {\n    \"Crashed\": CategoryCombination.Crashed,\n    \"Data loss\": CategoryCombination.DataLoss,\n    \"Security breach\": CategoryCombination.SecurityBreach,\n    \"Off by one\": CategoryCombination.OffByOne,\n    \"Slow\": CategoryCombination.Slow,\n    \"Stack overflow\": CategoryCombination.StackOverflow,\n};\n\ntype CategoryLabel = keyof typeof categoriesRaw;\n\nconst categories: Record<CategoryLabel, QueryColumn<boolean>> = categoriesRaw;\n\nexport function TypesOfError({ pageFilters, fetch }: VisualProps) {\n\n    const id = \"TypesOfError\";\n\n    // In the query we ask for the bits describing the categories applicable to each bug\n    const query = {\n        select: {\n            categoryBits: Bug.CategoryCombinationId, \n            workflowState: Workflow.WorkflowState,\n            bugCount: Bug.Id.count()\n        },\n        filters: [\n            Workflow.Resolved.equalTo(true),\n            ...pageFilters.getFilters(id)\n        ]\n    };\n\n    const data = useQuery(fetch, query);\n\n    const chart = useRef<Bar>(null);\n\n    const clickHandler = makeClickHandler(id, chart, \n        keys => [\n            Workflow.WorkflowState.equalTo(keys[1]), \n            categories[keys[0] as CategoryLabel].equalTo(true)\n        ],\n        pageFilters\n    );\n\n    const distinctWorkflowStates = distinct(data.records.map(r => r.workflowState));\n\n    // Convert the bit combinations into category labels\n    const bugCountByStateAndCategory = distinctWorkflowStates.flatMap(workflowState =>\n        keysOf(categories).map((category, bit) => ({\n            workflowState,\n            category,\n            bugCount: data.records\n                .filter(r => r.workflowState === workflowState && r.categoryBits & (1 << bit))\n                .map(r => r.bugCount)\n                .reduce((l, r) => l + r, 0)\n        })));\n\n    // Sum up the categories (full height of each bar)\n    const bugCountByCategory = keysOf(categories).map(category => ({\n        category,\n        bugCount: bugCountByStateAndCategory\n            .filter(r => r.category === category)\n            .map(r => r.bugCount)\n            .reduce((l, r) => l + r, 0)\n    }));\n\n    // Sort by bugCount descending so tallest bar is first\n    bugCountByCategory.sort((x, y) => y.bugCount - x.bugCount);\n\n    // Omit empty categories\n    const orderedCategories = bugCountByCategory.filter(c => c.bugCount > 0).map(c => c.category);\n\n    return (\n        <TinyBIChartBox id={id} title=\"Types Of Error\">\n            <Bar \n                ref={chart}\n                options={{ \n                    scales: {\n                        xAxes: [ { stacked: true } ],\n                        yAxes: [ { stacked: true, ticks: { beginAtZero: true } } ]\n                    },\n                    ...clickHandler\n                }}\n                data={{\n                    labels: orderedCategories,\n                    datasets: distinctWorkflowStates.map((workflowState, colour) => ({\n                        label: workflowState,\n                        data: orderedCategories.map(category =>\n                            bugCountByStateAndCategory.find(r => r.workflowState === workflowState && \n                                                                 r.category === category)?.bugCount ?? 0),\n                        backgroundColor: dataColours[colour]\n                    }))\n                }}\n            />\n        </TinyBIChartBox>\n    )\n}\n","import React from \"react\";\nimport { TinyBITable, useQuery, TinyBIChartBox } from \"tinybi-react\";\nimport { Bug, Workflow } from \"../demoSchema\";\nimport { VisualProps } from \"./VisualProps\";\n\nexport interface RecoverySummaryProps extends VisualProps {\n    fixedByCustomer: boolean;\n    title: string;\n}\n\nexport function RecoverySummary({ pageFilters, fixedByCustomer, title, fetch }: RecoverySummaryProps) {\n\n    const data = useQuery(fetch, {\n        select: {\n            state: Workflow.WorkflowState,\n            bugCount: Bug.Id.count(),\n            resolvedBugCount: Bug.Id.count([\n                Workflow.Resolved.equalTo(true)\n            ])\n        },\n        filters: [\n            Workflow.FixedByCustomer.equalTo(fixedByCustomer),\n            ...pageFilters.getFilters(\"\"),\n        ],\n        totals: true\n    });\n\n    return (\n        <TinyBIChartBox title={title}>\n            <TinyBITable\n                data={data}\n                columns={{\n                    State: (d) => d.values.state ?? \"Total\",\n                    Count: (d) => [`${d.values.bugCount}`, \"right\"],\n                    \"% of Count\": (d) => [`${d.percentage(\"resolvedBugCount\")}%`, \"right\"],\n                }} \n            />\n        </TinyBIChartBox>\n    );\n}\n","import React, { useRef } from \"react\";\nimport { QueryColumn, smartDates } from \"tinybi\";\nimport { useDropDown, DropDown, useQuery, TinyBIChartBox } from \"tinybi-react\";\nimport { Bug, Workflow, DateReported } from \"../demoSchema\";\nimport { dataColours } from \"./dataColours\";\nimport { ChartDataSets, ChartOptions, ChartData } from \"chart.js\";\nimport { Bar } from \"react-chartjs-2\";\nimport { VisualProps } from \"./VisualProps\";\nimport { makeClickHandler } from \"tinybi-react-chartjs\";\n\nconst dateGroupings = [\n    { label: \"Month\", value: DateReported.FirstDayOfMonth },\n    { label: \"Quarter\", value: DateReported.FirstDayOfQuarter },\n    { label: \"Year\", value: DateReported.CalendarYearNumber }\n]\n\nexport function BugsOverTime({ pageFilters, fetch }: VisualProps) {\n\n    const id = \"BugsOverTime\";\n\n    const dateGrouping = useDropDown<QueryColumn<Date|number>>(dateGroupings);\n\n    const query = {\n        select: {\n            period: dateGrouping.selected,        \n            countAllCauses: Bug.Id.count(),\n            countHackers: Bug.Id.count([\n                Workflow.SourceOfError.equalTo(\"Hackers\")\n            ]),\n        },\n        filters: [\n            Workflow.Resolved.equalTo(true),\n            ...pageFilters.getFilters(id)\n        ],\n        orderBy: [dateGrouping.selected.ascending()],        \n    };\n\n    const result = useQuery(fetch, query);\n\n    const datedRecords = smartDates(result.records, r => r.period, (dateLabel, record) => ({\n        dateLabel,\n        countAllCauses: 0,\n        countHackers: 0,\n        ...record \n    }));\n\n    const ref = useRef<Bar>(null);\n\n    const clickHandler = makeClickHandler(id, ref, query.select!, pageFilters);\n    \n    const hackers: ChartDataSets = {\n        type: \"line\",\n        data: datedRecords.map(r => r.countHackers ?? 0),\n        label: \"Hackers\",\n        backgroundColor: \"transparent\",\n        lineTension: 0,\n        borderColor: dataColours[1],\n    };\n    \n    const allCauses: ChartDataSets = {\n        data: datedRecords.map(r => r.countAllCauses),\n        label: \"All Causes\",\n        backgroundColor: dataColours[0]\n    };\n    \n    const data: ChartData = {\n        labels: datedRecords.map(x => x.dateLabel),\n        datasets: [hackers, allCauses],\n    };\n\n    const options: ChartOptions = {\n        ...clickHandler,\n        scales: {\n            yAxes: [{ ticks: { beginAtZero: true } }]\n        }\n    };\n\n    return (\n        <TinyBIChartBox id={id} title=\"Bugs Over Time\">\n            <div className=\"chart-with-dropdown\">\n                <div className=\"content\">\n                    <Bar ref={ref} options={options} data={data} />\n                </div>            \n                <div className=\"dropdown\">\n                    <span>By </span><DropDown {...dateGrouping} />\n                </div>\n            </div>            \n        </TinyBIChartBox>\n    );\n}\n","import React from \"react\";\nimport { Layout, Column, Row } from \"tinybi-react\";\nimport { VisualProps } from \"./VisualProps\";\nimport { ResolvedPerCustomer } from \"./ResolvedPerCustomer\";\nimport { SourceOfErrors } from \"./SourceOfErrors\";\nimport { TypesOfError } from \"./TypesOfError\";\nimport { RecoverySummary } from \"./RecoverySummary\";\nimport { BugsOverTime } from \"./BugsOverTime\";\n\nexport function BugReporting(props: VisualProps) {\n    return (\n        <Layout>\n            <Column>\n                <Row sizes={[1, 1, 2]}>\n                    <ResolvedPerCustomer {...props} />\n                    <SourceOfErrors {...props} />\n                    <TypesOfError {...props} />\n                </Row>\n                <Row>\n                    <BugsOverTime {...props} />\n                    <Column>\n                        <RecoverySummary {...props} title=\"Progress Summary\" fixedByCustomer={false} />\n                        <RecoverySummary {...props} title=\"Fixed By Customers\" fixedByCustomer={true} />\n                    </Column>\n                </Row>\n            </Column>\n        </Layout>\n    );\n}\n","import React, { useState } from \"react\";\nimport { DateReported } from \"./demoSchema\";\nimport { PageFilters } from \"tinybi-react\";\n\nfunction lastYear() {\n    const d = new Date();\n    d.setFullYear(d.getFullYear() - 5);\n    return d;\n}\n\nfunction toDateString(d: Date) {\n    return d.toISOString().substr(0, 10);\n}\n\nfunction useDateInput(init: Date) {\n    const [editing, setEditing] = useState(toDateString(init));\n    const [applied, setApplied] = useState(toDateString(init));\n\n    function apply() {\n        setApplied(editing);\n    }\n\n    function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n        setEditing(event.target.value);\n    }\n\n    return {\n        editing,\n        applied,\n        dirty: editing !== applied,\n        onChange,\n        apply        \n    };\n}\n\nlet initCounter = 0;\n\nexport function useFilterPane(pageFilters: PageFilters) {\n    const [visible, setVisible] = useState(false);\n    const from = useDateInput(lastYear());\n    const to = useDateInput(new Date());    \n    const dates = [from, to];\n\n    function toggle() {\n        setVisible(!visible);\n    }\n\n    function apply() {\n        dates.forEach(d => d.apply());\n        pageFilters.setGlobal([\n            DateReported.Id.greaterThanOrEqualTo(new Date(from.editing)),\n            DateReported.Id.lessThanOrEqualTo(new Date(to.editing))\n        ]);\n    }\n\n    const [init] = useState(++initCounter);\n    if (init === initCounter) {\n        apply();\n    }\n\n    const title = `Entered date from ${from.applied} to ${to.applied}`;\n\n    const dirty = dates.some(d => d.dirty);\n\n    return { visible, toggle, from, to, dirty, title, apply };\n}\n\nexport interface FilterPaneProps {\n    filterPane: ReturnType<typeof useFilterPane>; \n}\n\nexport function FilterPane({ filterPane: { visible, from, to, apply, dirty } }: FilterPaneProps) {\n    return (\n        <div className={`filter-pane ${visible && \"visible\"}`}>\n            <div>From</div>\n            <input type=\"date\" value={from.editing} onChange={from.onChange}/>\n            <div>To</div>\n            <input type=\"date\" value={to.editing} onChange={to.onChange}/>\n            <div className={`button ${dirty && \"enabled\"}`} onClick={apply}>Update</div>                 \n        </div>\n    )\n}\n","import moment from \"moment\";\n\nasync function allocDb() {\n    const publicUrl = (window as any).sitePublicUrl;\n\n    const SQL = await initSqlJs({\n        locateFile(f) {\n            return `${publicUrl}/${f}`;\n        }\n    });\n\n    const db = new SQL.Database();\n    setupDb(db);\n    return db;\n}\n\nlet db: ReturnType<typeof allocDb> | undefined;\n\ntype Await<T> = T extends {\n    then(onfulfilled?: (value: infer U) => unknown): unknown;\n} ? U : T;\n\nexport type Database = NonNullable<Await<typeof db>>;\n\nexport function getDb(): Promise<Database> {\n    if (!db) {\n        db = allocDb();\n    }\n    return db;\n}\n\nfunction makeRandomDate() {\n    const d = new Date(2018, 0, 1);\n    d.setDate(d.getDate() + Math.floor(Math.random() * 800));\n    return d;\n}\n\nfunction formatDate(d: Date) {\n    return moment(d).format(\"YYYY-MM-DD\");\n}\n\nfunction startOfQuarter(d: Date) {\n    const m = Math.floor(d.getMonth() / 3) * 3;\n    return formatDate(new Date(d.getFullYear(), m, 1));\n}\n\nfunction startOfMonth(d: Date) {    \n    return formatDate(new Date(d.getFullYear(), d.getMonth(), 1));\n}\n\nfunction pick(count: number, base: number) {\n     return Math.min(count - 1, Math.floor(Math.random() * count)) + base;     \n}\n\nfunction setupDb(db: Database) {\n\n    const workflowStates = [\n        \"Ignored\",\n        \"Prioritised\",\n        \"Assigned\",\n        \"Fixed\",\n        \"AsDesigned\"\n    ];\n\n    const sourcesOfError = [\n        \"Design flaw\",\n        \"Hackers\",\n        \"Honest mistake\"\n    ];\n\n    const dates: Date[] = [];\n    for (let n = 0; n < 50; n++) {\n        dates.push(makeRandomDate());\n    }\n\n    const dateRows = dates.map(x => `\n        ('${formatDate(x)}', ${x.getFullYear()}, '${startOfQuarter(x)}', '${startOfMonth(x)}')`).join(\",\");\n\n    const workflows: string[] = [];\n\n    for (const workflowState of workflowStates) {\n        for (const sourceOfError of sourcesOfError) {\n            for (const resolved of [0, 1]) {\n                for (const fixedByCustomer of [0, 1]) {\n                    workflows.push(`\n                        (${workflows.length + 1}, ${resolved}, '${workflowState}', '${sourceOfError}', ${fixedByCustomer})`);\n                }\n            }\n        }\n    }\n\n    const workflowRows = workflows.join(\",\");\n\n    const categoryCombinations: string[] = [];\n\n    for (const a of [0, 1]) {\n        for (const b of [0, 1]) {\n            for (const c of [0, 1]) {\n                for (const d of [0, 1]) {\n                    for (const e of [0, 1]) {\n                        for (const f of [0, 1]) {\n                            categoryCombinations.push(`\n                                (${categoryCombinations.length}, ${a}, ${b}, ${c}, ${d}, ${e}, ${f})`);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    const categoryCombinationsRows = categoryCombinations.join(\",\");\n\n    const bugs: string[] = [];\n\n    for (var n = 0; n < 100; n++) {\n        const workflow = pick(workflows.length, 1);\n        const customer = pick(6, 1);\n        const reported = formatDate(dates[pick(dates.length, 0)]);\n        const resolved = formatDate(dates[pick(dates.length, 0)]);\n        const assigned = formatDate(dates[pick(dates.length, 0)]);\n        const catComb = pick(categoryCombinations.length, 1);\n        const coderAssigned = pick(6, 1);\n        const coderResolved = pick(6, 1);\n\n        bugs.push(`\n            (${n + 1}, ${workflow}, ${customer}, '${reported}', '${resolved}', '${assigned}', ${catComb}, ${coderAssigned}, ${coderResolved})`);\n    }\n\n    const bugRows = bugs.join(\",\");\n\n    const initSql = `\n        create table \\`Date\\` (\n            Id date,\n            CalendarYearNumber smallint,\n            FirstDayOfQuarter date,\n            FirstDayOfMonth date\n        );\n\n        insert into \\`Date\\` values ${dateRows};\n\n        create table \\`Workflow\\` (\n            Id int,\n            Resolved bit,\n            WorkflowState varchar(30),\n            SourceOfError varchar(30),\n            FixedByCustomer bit\n        );\n\n        insert into \\`Workflow\\` values ${workflowRows};\n\n        create table \\`Category\\` (\n            Id int,\n            Label varchar(30)\n        );\n\n        insert into \\`Category\\` values\n            (1, 'Crashed'),\n            (2, 'Data Loss'),\n            (3, 'Security Breach'),\n            (4, 'Off By One'),\n            (5, 'Slow'),\n            (6, 'StackOverflow');\n\n        create table \\`Coder\\` (\n            Id int,\n            FullName varchar(30)\n        );\n    \n        insert into \\`Coder\\` values\n                (1, 'Sam'),\n                (2, 'Alex'),\n                (3, 'Drew'),\n                (4, 'Taylor'),\n                (5, 'Parker'),\n                (6, 'Austin');\n\n        create table \\`Customer\\` (\n            Id int,\n            CustomerName varchar(30)\n        );\n    \n        insert into \\`Customer\\` values\n                (1, 'Pies LLC'),\n                (2, 'Buns, Inc.'),\n                (3, 'Hats-R-Us'),\n                (4, 'Silence'),\n                (5, 'Egypt'),\n                (6, 'Affordability');\n\n        create table \\`CategoryCombination\\` (\n            Id int,\n            StackOverflow bit,\n            Slow bit,\n            OffByOne bit,\n            SecurityBreach bit,\n            DataLoss bit,\n            Crashed bit\n        );\n\n        insert into \\`CategoryCombination\\` values ${categoryCombinationsRows};\n\n        create table \\`Bug\\` (\n            Id int,\n            WorkflowId int,\n            CustomerId int,\n            ReportedDate date,\n            ResolvedDate date,\n            AssignedDate date,\n            CategoryCombinationId int,\n            AssignedCoderId int,\n            ResolvedCoderId int\n        );\n\n        insert into \\`Bug\\` values ${bugRows};\n    `;\n\n    db.run(initSql);\n}\n","import { jsonDateParser } from \"json-date-parser\";\nimport { getDb } from \"./database\";\nimport { QueryResult, QuerySelectValue } from \"tinybi\";\n\nasync function querySql(sql: string) {\n    \n    const db = await getDb();\n\n    sql = sql.replace(/[[\\]]/g, \"\")\n             .replace(/top\\s+[\\d]+/g, \" \")\n             .replace(/BugTracking\\./g, \"\");\n\n    return JSON.stringify(db.exec(sql));\n}\n\n(window as any).querySql = querySql;\n\nconst blazorReady = new Promise(done => (window as any).notifyBlazorReady = done);\n\nexport async function localFetch(queryJson: string): Promise<QueryResult> {\n\n    await blazorReady;\n\n    const json = await DotNet.invokeMethodAsync(\"TinyBI.WasmHost\", \"Query\", queryJson) as string;\n    const parsed = JSON.parse(json, jsonDateParser);\n\n    if (parsed.stackTrace) {\n        console.error(parsed);\n        return { records: [] };\n    }\n\n    if (!parsed[0]) {\n        console.error(parsed);\n        return { records: [] };\n    }\n\n    const columns = parsed[0].columns;\n    const values = parsed[0].values as QuerySelectValue[][];\n    const firstValueIndex = columns.indexOf(\"Value0\");\n    const endOfSelects = firstValueIndex === -1 ? columns.length : firstValueIndex;\n\n    const result: QueryResult = {\n        records: values.map(x => ({\n            selected: x.slice(0, endOfSelects),\n            aggregated: x.slice(endOfSelects) as number[]\n        }))\n    };\n    \n    if (parsed[1]) {\n        result.totals = {\n            selected: [],\n            aggregated: parsed[1].values\n        };\n    }\n\n    return result;\n}\n","import React, { useState } from \"react\";\nimport \"./App.css\";\nimport { BugReporting } from \"./Reports/BugReporting\";\nimport { VisualProps } from \"./Reports/VisualProps\";\nimport { usePageFilters } from \"tinybi-react\";\nimport { useFilterPane, FilterPane } from \"./FilterPane\";\nimport Chart from \"chart.js\";\nimport { localFetch } from \"./localFetch\";\n\nChart.defaults.global.defaultFontFamily = \"Segoe UI, 'Helvetica', 'Arial', sans-serif\";\nif (Chart.defaults.global.legend && Chart.defaults.global.legend.labels) {\n    Chart.defaults.global.legend.labels.usePointStyle = true;\n}\n\nChart.defaults.global.maintainAspectRatio = false;\n\nconst reports = {\n    \"Bug Tracking\": (f: VisualProps) => <BugReporting {...f} />,    \n}\n\ntype ReportName = keyof typeof reports;\n\nconst reportNames = Object.keys(reports) as ReportName[];\n\nconst defaultReport: ReportName = \"Bug Tracking\";\n\nfunction App() {\n    const [reportName, setReportName] = useState(defaultReport);\n    const pageFilters = usePageFilters();\n    const filterPane = useFilterPane(pageFilters);\n\n    const report = reports[reportName];\n\n    return (\n        <div className=\"reports-site\">\n            <div className=\"list\">\n                {\n                    reportNames.map(n => (\n                        <div key={n}\n                            className={`item ${n === reportName && \"selected\"}`}\n                            onClick={() => setReportName(n)}>{n}</div>\n                    ))\n                }\n            </div>\n            <div className=\"content\">\n                <div className=\"title-bar\">\n                    <div className=\"title\">{filterPane.title}</div>\n                    <div className=\"filters-button\" onClick={filterPane.toggle}>Filters</div>\n                </div>\n                <div className=\"report-with-filters\">\n                    <div className=\"report-itself\" onClick={pageFilters.clearInteraction}>\n                        {report({ fetch: localFetch, pageFilters })}\n                    </div>\n                    <FilterPane filterPane={filterPane} />\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { getAggregatePropsOnly, getColumnPropsOnly } from \"./queryModel\";\nexport function jsonifyQuery(query) {\n    var select = query.select, others = __rest(query, [\"select\"]);\n    return __assign(__assign({}, others), { select: getColumnPropsOnly(select).map(function (key) { return select[key].name; }), aggregations: getAggregatePropsOnly(select).map(function (key) { return select[key]; }) });\n}\nexport function expandQueryRecord(select, record) {\n    var result = {};\n    var n = 0;\n    for (var _i = 0, _a = getAggregatePropsOnly(select); _i < _a.length; _i++) {\n        var key = _a[_i];\n        result[key] = record.aggregated[n++];\n    }\n    n = 0;\n    for (var _b = 0, _c = getColumnPropsOnly(select); _b < _c.length; _b++) {\n        var key = _c[_b];\n        result[key] = record.selected[n++];\n    }\n    return result;\n}\nexport function getAggregateValuesOnly(select, record) {\n    var result = {};\n    var n = 0;\n    for (var _i = 0, _a = getAggregatePropsOnly(select); _i < _a.length; _i++) {\n        var key = _a[_i];\n        result[key] = record.aggregated[n++];\n    }\n    return result;\n}\nexport function expandQueryResult(select, result) {\n    return {\n        records: result.records.map(function (r) { return expandQueryRecord(select, r); }),\n        totals: result.totals && getAggregateValuesOnly(select, result.totals)\n    };\n}\nexport function executeQuery(fetch, query) {\n    return fetch(JSON.stringify(query));\n}\n","var QueryValuesRow = /** @class */ (function () {\n    function QueryValuesRow(values, totals) {\n        this.values = values;\n        this.totals = totals;\n    }\n    QueryValuesRow.prototype.percentage = function (key) {\n        var _a;\n        if (!this.totals)\n            return 0;\n        var rawValue = this.values[key];\n        var total = (_a = this.totals[key], (_a !== null && _a !== void 0 ? _a : 0));\n        var percent = total === 0 ? 0 : (rawValue / total) * 100;\n        return Math.round(percent * 100) / 100;\n    };\n    return QueryValuesRow;\n}());\nexport { QueryValuesRow };\nvar QueryValuesTotal = /** @class */ (function () {\n    function QueryValuesTotal(totals) {\n        this.values = totals;\n    }\n    QueryValuesTotal.prototype.percentage = function () {\n        return 100;\n    };\n    return QueryValuesTotal;\n}());\nexport { QueryValuesTotal };\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport moment from \"moment\";\nfunction detectDateType(dates) {\n    if (!dates.every(function (x) { return x.date() === 1; })) {\n        return { format: \"ll\", unit: \"days\", incr: 1 };\n    }\n    if (!dates.every(function (x) { return x.month() % 3 === 0; })) {\n        return { format: \"MMM YYYY\", unit: \"months\", incr: 1 };\n    }\n    if (!dates.every(function (x) { return x.month() === 0; })) {\n        return { format: \"[Q]Q YYYY\", unit: \"months\", incr: 3 };\n    }\n    return { format: \"YYYY\", unit: \"years\", incr: 1 };\n}\nexport function smartDates(records, getDate, mapTo) {\n    records = __spreadArrays(records);\n    records.sort(function (x, y) { return moment(getDate(x)).diff(moment(getDate(y))); });\n    var _a = detectDateType(records.map(function (d) { return moment(getDate(d)); })), format = _a.format, unit = _a.unit, incr = _a.incr;\n    var results = [];\n    var latest = undefined;\n    for (var _i = 0, records_1 = records; _i < records_1.length; _i++) {\n        var record = records_1[_i];\n        var current = moment(getDate(record));\n        if (latest) {\n            for (;;) {\n                latest = latest.add(incr, unit);\n                if (latest >= current) {\n                    break;\n                }\n                results.push(mapTo(latest.format(format), undefined));\n            }\n        }\n        results.push(mapTo(current.format(format), record));\n        latest = current;\n    }\n    return results;\n}\n","import { keysOf } from \"./arrayHelpers\";\nimport { QueryColumn } from \"./QueryColumn\";\nexport function getAggregatePropsOnly(select) {\n    var keys = keysOf(select).filter(function (x) { return !(select[x] instanceof QueryColumn); });\n    return keys;\n}\nexport function getColumnPropsOnly(select) {\n    var keys = keysOf(select).filter(function (x) { return select[x] instanceof QueryColumn; });\n    return keys;\n}\nexport function getColumnsOnly(select) {\n    return keysOf(select)\n        .map(function (k) { return select[k]; })\n        .filter(function (x) { return x instanceof QueryColumn; })\n        .map(function (x) { return x; });\n}\n"],"sourceRoot":""}